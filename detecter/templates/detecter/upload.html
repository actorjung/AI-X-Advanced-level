<!DOCTYPE html>
{% load static %}
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <title>detection</title>
    <link rel="stylesheet" href="{% static 'css/style.css' %}">
    <link rel="stylesheet" href="{% static 'css/design.css' %}">
</head>
<body>
    <header class="header">
        <nav class="nav-items">
        <img onclick="movePage_home()" src="{% static 'img/logo.png' %}" href="home.html" class="logo" alt="logo">
        </nav>
      </header>

    <h1>동영상 업로드 및 분석</h1>

    <input type="file" accept="video/*" id="videoInput" onchange="playAndAnalyze()">
    <video controls id="videoPlayer" onended="analyzeVideo()">
        현재 브라우저는 video 태그를 지원하지 않습니다.
    </video>

    <!-- 분석하기 버튼 추가 -->
    <button onclick="showLoading()">분석하기</button>
    <!-- 로딩 창 -->
    <div class="loading" id="loading">
        <img src="{% static 'img/icons8-loading.gif' %}" alt="Loading">
    </div>

    <script>

        function movePage_home() {
        window.location.href = '{% url "home" %}';
        }
        function playAndAnalyze() {
            const videoInput = document.getElementById('videoInput');
            const videoPlayer = document.getElementById('videoPlayer');

            const file = videoInput.files[0];

            if (file) {
                const objectURL = URL.createObjectURL(file);
                videoPlayer.src = objectURL;
                videoPlayer.play();
            }
        }

        function analyzeVideo() {
            // 동영상이 종료되면 분석 페이지로 이동하는 코드를 여기에 추가하세요.
            alert('동영상 재생이 완료되었습니다. 분석 페이지로 이동합니다.');
           // redirectToDetection();
        }

        // 분석 페이지로 이동하는 함수
        function redirectToDetection() {
            window.location.href = '{% url "result" %}'; // 분석 페이지의 실제 주소로 변경해주세요.
        }

        function showLoading() {
            const loading = document.getElementById('loading');
            loading.style.display = 'flex'; // 로딩 창 표시
            setTimeout(redirectToDetection, 3000); // 3초 후에 분석 페이지로 이동 (3초는 예시입니다)
        }
    </script>
</body>
</html>
